<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MQTT File Streams Downloader: MQTTFileDownloader.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MQTT File Streams Downloader<span id="projectnumber">&#160;v1.1.0</span>
   </div>
   <div id="projectbrief">MQTT file streams downloader library</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('_m_q_t_t_file_downloader_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">MQTTFileDownloader.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>MQTT file streaming APIs.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="_m_q_t_t_file_downloader_8h_source.html">MQTTFileDownloader.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_m_q_t_t_file_downloader__defaults_8h_source.html">MQTTFileDownloader_defaults.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_m_q_t_t_file_downloader__base64_8h_source.html">MQTTFileDownloader_base64.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_m_q_t_t_file_downloader__cbor_8h_source.html">MQTTFileDownloader_cbor.h</a>&quot;</code><br />
<code>#include &quot;core_json.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:acfe6037f87fbca111fe045ae4826e1c8"><td class="memItemLeft" align="right" valign="top"><a id="acfe6037f87fbca111fe045ae4826e1c8" name="acfe6037f87fbca111fe045ae4826e1c8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IS_CHAR_DIGIT</b>(x)&#160;&#160;&#160;( ( ( x ) &gt;= '0' ) &amp;&amp; ( ( x ) &lt;= '9' ) )</td></tr>
<tr class="memdesc:acfe6037f87fbca111fe045ae4826e1c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Macro to check whether a character is an ASCII digit or not. <br /></td></tr>
<tr class="separator:acfe6037f87fbca111fe045ae4826e1c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28acbdfce4526d17185162083b3b5e91"><td class="memItemLeft" align="right" valign="top"><a id="a28acbdfce4526d17185162083b3b5e91" name="a28acbdfce4526d17185162083b3b5e91"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CHAR_TO_DIGIT</b>(x)&#160;&#160;&#160;( ( x ) - '0' )</td></tr>
<tr class="memdesc:a28acbdfce4526d17185162083b3b5e91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Macro to convert an ASCII digit to integer. <br /></td></tr>
<tr class="separator:a28acbdfce4526d17185162083b3b5e91"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af4f15c87ad928ef5b1da15245a1a1a57"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_q_t_t_file_downloader_8c.html#af4f15c87ad928ef5b1da15245a1a1a57">stringBuilder</a> (char *buffer, size_t bufferSizeBytes, const char *const strings[])</td></tr>
<tr class="memdesc:af4f15c87ad928ef5b1da15245a1a1a57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build a string from a set of strings.  <br /></td></tr>
<tr class="separator:af4f15c87ad928ef5b1da15245a1a1a57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40a2c0daac80ca1aedb1d26bd9a089af"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_q_t_t_file_downloader_8c.html#a40a2c0daac80ca1aedb1d26bd9a089af">createTopic</a> (char *topicBuffer, size_t topicBufferLen, const char *streamName, size_t streamNameLength, const char *thingName, size_t thingNameLength, const char *apiSuffix)</td></tr>
<tr class="memdesc:a40a2c0daac80ca1aedb1d26bd9a089af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create MQTT topics from common substrings and input variables.  <br /></td></tr>
<tr class="separator:a40a2c0daac80ca1aedb1d26bd9a089af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada78532dea97d6c89a02251dcdad8bca"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__mqtt__file__downloader__enum__types.html#gae44d6f828acad731f4f8d615d9c27f04">MQTTFileDownloaderStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_q_t_t_file_downloader_8c.html#ada78532dea97d6c89a02251dcdad8bca">handleCborMessage</a> (const uint8_t *message, size_t messageLength, int32_t *fileId, int32_t *blockId, int32_t *blockSize, uint8_t *decodedData, size_t *decodedDataLength)</td></tr>
<tr class="memdesc:ada78532dea97d6c89a02251dcdad8bca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles and decodes the received message in CBOR format.  <br /></td></tr>
<tr class="separator:ada78532dea97d6c89a02251dcdad8bca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31be06c693bde635cf11b9d468c23dca"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__mqtt__file__downloader__enum__types.html#gae44d6f828acad731f4f8d615d9c27f04">MQTTFileDownloaderStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_q_t_t_file_downloader_8c.html#a31be06c693bde635cf11b9d468c23dca">handleJsonMessage</a> (uint8_t *message, size_t messageLength, int32_t *fileId, int32_t *blockId, int32_t *blockSize, uint8_t *decodedData, size_t *decodedDataLength)</td></tr>
<tr class="memdesc:a31be06c693bde635cf11b9d468c23dca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles and decodes the received message in JSON format.  <br /></td></tr>
<tr class="separator:a31be06c693bde635cf11b9d468c23dca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8db4c228f794a386fb88001f06a1ac6d"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_q_t_t_file_downloader_8c.html#a8db4c228f794a386fb88001f06a1ac6d">getNumberFromString</a> (const char *str, size_t len, int32_t *num)</td></tr>
<tr class="memdesc:a8db4c228f794a386fb88001f06a1ac6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses C-string interpreting its contents as a POSITIVE int32_t number.  <br /></td></tr>
<tr class="separator:a8db4c228f794a386fb88001f06a1ac6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3d6f5b033e5fe25e2a4a862741d5616"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__mqtt__file__downloader__enum__types.html#gae44d6f828acad731f4f8d615d9c27f04">MQTTFileDownloaderStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_q_t_t_file_downloader_8c.html#ac3d6f5b033e5fe25e2a4a862741d5616">mqttDownloader_init</a> (<a class="el" href="struct_mqtt_file_downloader_context__t.html">MqttFileDownloaderContext_t</a> *context, const char *streamName, size_t streamNameLength, const char *thingName, size_t thingNameLength, <a class="el" href="group__mqtt__file__downloader__enum__types.html#ga405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> dataType)</td></tr>
<tr class="memdesc:ac3d6f5b033e5fe25e2a4a862741d5616"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the MQTT file downloader. Creates the topic name the DATA and Get Stream Data topics.  <br /></td></tr>
<tr class="separator:ac3d6f5b033e5fe25e2a4a862741d5616"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11441c07bf2c51cc1ef9caff4643a7ca"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_q_t_t_file_downloader_8c.html#a11441c07bf2c51cc1ef9caff4643a7ca">mqttDownloader_createGetDataBlockRequest</a> (<a class="el" href="group__mqtt__file__downloader__enum__types.html#ga405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> dataType, uint16_t fileId, uint32_t blockSize, uint16_t blockOffset, uint32_t numberOfBlocksRequested, char *getStreamRequest, size_t getStreamRequestLength)</td></tr>
<tr class="memdesc:a11441c07bf2c51cc1ef9caff4643a7ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates the get request for Data blocks from MQTT Streams.  <br /></td></tr>
<tr class="separator:a11441c07bf2c51cc1ef9caff4643a7ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae34d11982ba7c090d4f82ceaa435d0a5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__mqtt__file__downloader__enum__types.html#gae44d6f828acad731f4f8d615d9c27f04">MQTTFileDownloaderStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_q_t_t_file_downloader_8c.html#ae34d11982ba7c090d4f82ceaa435d0a5">mqttDownloader_isDataBlockReceived</a> (const <a class="el" href="struct_mqtt_file_downloader_context__t.html">MqttFileDownloaderContext_t</a> *context, const char *topic, size_t topicLength)</td></tr>
<tr class="memdesc:ae34d11982ba7c090d4f82ceaa435d0a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the incoming Publish message contains MQTT Data block.  <br /></td></tr>
<tr class="separator:ae34d11982ba7c090d4f82ceaa435d0a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c73fd85520931e8a269721f2954a150"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__mqtt__file__downloader__enum__types.html#gae44d6f828acad731f4f8d615d9c27f04">MQTTFileDownloaderStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_q_t_t_file_downloader_8c.html#a2c73fd85520931e8a269721f2954a150">mqttDownloader_processReceivedDataBlock</a> (const <a class="el" href="struct_mqtt_file_downloader_context__t.html">MqttFileDownloaderContext_t</a> *context, uint8_t *message, size_t messageLength, int32_t *fileId, int32_t *blockId, int32_t *blockSize, uint8_t *data, size_t *dataLength)</td></tr>
<tr class="memdesc:a2c73fd85520931e8a269721f2954a150"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the data block from incoming MQTT message and decode it.  <br /></td></tr>
<tr class="separator:a2c73fd85520931e8a269721f2954a150"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>MQTT file streaming APIs. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="af4f15c87ad928ef5b1da15245a1a1a57" name="af4f15c87ad928ef5b1da15245a1a1a57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4f15c87ad928ef5b1da15245a1a1a57">&#9670;&#160;</a></span>stringBuilder()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t stringBuilder </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>bufferSizeBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *const&#160;</td>
          <td class="paramname"><em>strings</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build a string from a set of strings. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buffer</td><td>Buffer to place the output string in. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bufferSizeBytes</td><td>Size of the buffer pointed to by buffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">strings</td><td>NULL-terminated array of string pointers. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>size_t Length of the output string, not including the terminator. </dd></dl>

</div>
</div>
<a id="a40a2c0daac80ca1aedb1d26bd9a089af" name="a40a2c0daac80ca1aedb1d26bd9a089af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40a2c0daac80ca1aedb1d26bd9a089af">&#9670;&#160;</a></span>createTopic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t createTopic </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>topicBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>topicBufferLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>streamName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>streamNameLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>thingName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>thingNameLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>apiSuffix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create MQTT topics from common substrings and input variables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">topicBuffer</td><td>Buffer to place the output topic in. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">topicBufferLen</td><td>Length of topicBuffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">streamName</td><td>Name of the MQTT stream. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">streamNameLength</td><td>Length of the MQTT stream name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thingName</td><td>Name of the thing. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thingNameLength</td><td>Length of the thing name of the Device. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">apiSuffix</td><td>Last part of the MQTT topic.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint16_t Length of the MQTT topic, not including the terminator. </dd></dl>

</div>
</div>
<a id="ada78532dea97d6c89a02251dcdad8bca" name="ada78532dea97d6c89a02251dcdad8bca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada78532dea97d6c89a02251dcdad8bca">&#9670;&#160;</a></span>handleCborMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__mqtt__file__downloader__enum__types.html#gae44d6f828acad731f4f8d615d9c27f04">MQTTFileDownloaderStatus_t</a> handleCborMessage </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>fileId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>blockId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>blockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>decodedData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>decodedDataLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handles and decodes the received message in CBOR format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">message</td><td>Incoming MQTT message received. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">messageLength</td><td>Length of the MQTT message received. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fileId</td><td>ID of the file to which the data block belongs. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">blockId</td><td>ID of the received block. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">blockSize</td><td>Size of the receive block in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">decodedData</td><td>Buffer to place the decoded data in. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">decodedDataLength</td><td>Length of decoded data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t returns appropriate MQTT File Downloader Status. </dd></dl>

</div>
</div>
<a id="a31be06c693bde635cf11b9d468c23dca" name="a31be06c693bde635cf11b9d468c23dca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31be06c693bde635cf11b9d468c23dca">&#9670;&#160;</a></span>handleJsonMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__mqtt__file__downloader__enum__types.html#gae44d6f828acad731f4f8d615d9c27f04">MQTTFileDownloaderStatus_t</a> handleJsonMessage </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>fileId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>blockId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>blockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>decodedData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>decodedDataLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handles and decodes the received message in JSON format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">message</td><td>Incoming MQTT message received. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">messageLength</td><td>Length of the MQTT message received. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fileId</td><td>ID of the file to which the data block belongs. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">blockId</td><td>ID of the received block. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">blockSize</td><td>Size of the receive block in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">decodedData</td><td>Buffer to place the decoded data in. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">decodedDataLength</td><td>Length of decoded data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t returns appropriate MQTT File Downloader Status. </dd></dl>

</div>
</div>
<a id="a8db4c228f794a386fb88001f06a1ac6d" name="a8db4c228f794a386fb88001f06a1ac6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8db4c228f794a386fb88001f06a1ac6d">&#9670;&#160;</a></span>getNumberFromString()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool getNumberFromString </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parses C-string interpreting its contents as a POSITIVE int32_t number. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">str</td><td>String which has the ASCII representation of the number. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>Length of the string. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">num</td><td>Pointer to an int32_t variable which will be filled with the parsed value. If the return value of the function call is false, then the value present in num is invalid.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool if the string is malformed or the decoded number cannot fit in an int32_t value then this function returns false. On successful parsing, it returns true. </dd></dl>

</div>
</div>
<a id="ac3d6f5b033e5fe25e2a4a862741d5616" name="ac3d6f5b033e5fe25e2a4a862741d5616"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3d6f5b033e5fe25e2a4a862741d5616">&#9670;&#160;</a></span>mqttDownloader_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__mqtt__file__downloader__enum__types.html#gae44d6f828acad731f4f8d615d9c27f04">MQTTFileDownloaderStatus_t</a> mqttDownloader_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_mqtt_file_downloader_context__t.html">MqttFileDownloaderContext_t</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>streamName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>streamNameLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>thingName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>thingNameLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__mqtt__file__downloader__enum__types.html#ga405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a>&#160;</td>
          <td class="paramname"><em>dataType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the MQTT file downloader. Creates the topic name the DATA and Get Stream Data topics. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>MQTT file downloader context pointer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">streamName</td><td>Stream name to download the file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">streamNameLength</td><td>Length of the Stream name to download the file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thingName</td><td>Thing name of the Device. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thingNameLength</td><td>Length of the Thing name of the Device. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dataType</td><td>Either JSON or CBOR data type.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>MQTTFileDownloaderStatus_t returns appropriate MQTT File Downloader Status. </dd></dl>

</div>
</div>
<a id="a11441c07bf2c51cc1ef9caff4643a7ca" name="a11441c07bf2c51cc1ef9caff4643a7ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11441c07bf2c51cc1ef9caff4643a7ca">&#9670;&#160;</a></span>mqttDownloader_createGetDataBlockRequest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t mqttDownloader_createGetDataBlockRequest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__mqtt__file__downloader__enum__types.html#ga405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a>&#160;</td>
          <td class="paramname"><em>dataType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>fileId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>blockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>blockOffset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>numberOfBlocksRequested</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>getStreamRequest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>getStreamRequestLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates the get request for Data blocks from MQTT Streams. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dataType</td><td>Either JSON or CBOR data type. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fileId</td><td>File Id of the file to be downloaded from MQTT Streams. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blockSize</td><td>Requested size of block. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blockOffset</td><td>Block Offset. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numberOfBlocksRequested</td><td>Number of Blocks requested per request. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">getStreamRequest</td><td>Buffer to store the get stream request. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">getStreamRequestLength</td><td>Length of getStreamRequest buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>size_t returns Length of the get stream request. </dd></dl>

</div>
</div>
<a id="ae34d11982ba7c090d4f82ceaa435d0a5" name="ae34d11982ba7c090d4f82ceaa435d0a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae34d11982ba7c090d4f82ceaa435d0a5">&#9670;&#160;</a></span>mqttDownloader_isDataBlockReceived()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__mqtt__file__downloader__enum__types.html#gae44d6f828acad731f4f8d615d9c27f04">MQTTFileDownloaderStatus_t</a> mqttDownloader_isDataBlockReceived </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_mqtt_file_downloader_context__t.html">MqttFileDownloaderContext_t</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>topicLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if the incoming Publish message contains MQTT Data block. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>MQTT file downloader context pointer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">topic</td><td>incoming Publish message MQTT topic. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">topicLength</td><td>incoming Publish message MQTT topic length.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>returns True if the message contains Data block else False. </dd></dl>

</div>
</div>
<a id="a2c73fd85520931e8a269721f2954a150" name="a2c73fd85520931e8a269721f2954a150"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c73fd85520931e8a269721f2954a150">&#9670;&#160;</a></span>mqttDownloader_processReceivedDataBlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__mqtt__file__downloader__enum__types.html#gae44d6f828acad731f4f8d615d9c27f04">MQTTFileDownloaderStatus_t</a> mqttDownloader_processReceivedDataBlock </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_mqtt_file_downloader_context__t.html">MqttFileDownloaderContext_t</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>fileId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>blockId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>blockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>dataLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the data block from incoming MQTT message and decode it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>MQTT file downloader context pointer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message</td><td>Incoming MQTT message containing data block. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">messageLength</td><td>Incoming MQTT message length. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fileId</td><td>ID of the file to which the data block belongs. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">blockId</td><td>ID of the received block. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">blockSize</td><td>Size of the receive block in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">data</td><td>Decoded data block. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dataLength</td><td>Decoded data block length.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>returns True if the message is handled else False. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="_m_q_t_t_file_downloader_8c.html">MQTTFileDownloader.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
